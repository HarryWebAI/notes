# 页面搭建

## HBuilderX创建项目

- `~/taolele/tll-app`, 其中 `taolele` 为整体项目存放路径, `tll-app` 为前端项目路径
- 正常创建默认项目, 采用 vue3 语法即可

## 下载 mumu 模拟器

- 下载地址: <https://mumu.163.com/>
- 正常安装即可, 不过只有7天免费
- 运行起来
- 用 HbuliderX 运行到安卓基座, 刷新列表找到该设备 (一般叫做 `emulator...`)

## 配置全局样式

- 老师提供了写好的样式表, 我们复制粘贴后放在了 `~/taolele/tll-app/commons/` 中
  - `common.css` => 公用样式
  - `uni.css` => uniApp样式
  - `tll.css` => 项目样式
- 另外在 `uni.css` 中引用了一个静态字体文件 `/static/uni.tff`, 记得拷贝过去
- 在 `App.vue` 中导入

```vue
<style>
 /*每个页面公共css */
 @import "@/commons/common.css";
 @import "@/commons/uni.css";
 @import "@/commons/tll.css";
</style>
```

- 导入样式: `@import "@/..."`, @符表示当前项目根
- 必须以上面的顺序导入, 实现当样式出现冲突时, 以 `tll.css` 的样式为准

## 前置基础

### 尺寸换算

- 在 uniapp 中, 如果想要使用固定尺寸, 就以 `px` 为单位
- 如果想实现响应式尺寸, 就需要使用 `rpx`, 它的基准标定是屏幕宽度为750px
- **换算公式**: `750 * 元素在设计稿中的宽度 / 设计稿基准宽度`
- 举例: 如果设计稿为 750px, 那么 100px = 100rpx
- 举例: 如果设计稿为 640px, 那么 100px = 117rpx (750 * 100 / 640)
- 举例, 如果设计稿为 375px, 那么 100px = 200rpx (750 * 100 / 375)

> 在实际工作中, 我们会收到 ui设计师的设计稿, 他们不一定以 750px 为设计稿宽度, 所以我们需要学会自己换算成 rpx 以实现响应式宽度, 来适配不同的设备

### sass

> 普通 css 无法处理逻辑, 甚至导入其他样式表都不行, 为了解决这一问题, sass 诞生了

- 后缀名为 `.scss`
- sass 需要编译为 css 才可以投入使用, HBuilderX 自带编译插件: 工具, 插件安装, 里面可以看见 `dart-sass编译` 插件

---

- 注释

```scss
/* 这是注释 */
// 这也是注释
```

- 嵌套: `#main .header { }`

```scss
#main {
    // 嵌套: 指 id 为 main 的元素里的 class 为 header 的元素具有以下样式
    .header{
        background: #ccc;
    }
}
```

- 引用父选择器 `a {}`, `a: hover {}`

```scss
a {
    font-weight: bold;
    // 引用父选择器: 通过 & 选择到 a 标签自身, 增加它 hover 鼠标悬浮时的样式
    &:hover {
        color: #888;
    }
}
```

- 定义变量

```scss
// 定义变量 $变量名: 值 (注意是冒号)
$mainWidth: 750px;

#main {
    // 使用变量
    widht: $mainWidth;
}
```

- 实现运算

```scss
.box {
    width: $mainWidth/3;
}
```

- 导入其他样式

```scss
@import "otherSass.scss"
```

- 样式继承

```scss
.error {
    backgroud-color: red;
}

.serious-error {
    // 继承样式
    @extend .error;
    font-weight: bold;
}
```

- 样式混入

```scss
// 定义通用样式
@mixin common-border($color, $widht) {
    // 边框样式
    border: {
        color: $color
        width: width;
        style: dashed;
    }
}

// ...

// 使用时需要传参
p {
    @include common-border(blue, 1px);
}
```

## 页面和tabBar

- 使用 HBuilderX 新建页面: 右键点击 `/pages/`, 选择新建页面, 输入页面名称, 勾选创建同名文件夹, 侧边选择组合式api(vue3), 这样创建页面会直接在 `pages.json` 中注册, 新建3个页面
  - seckill => 秒杀
  - order => 订单
  - mine => 个人中心
- 将老师准备好的静态图标文件拷贝后放在 `~/static/tabbars/` 中
- 配置tabBar, 编辑 `pages.json`

```json
{
 "pages": [
  // 先干掉 index 页, 下面这些页面都是自动注册进去的
  {
   "path" : "pages/seckill/seckill",
   "style" : 
   {
    "navigationBarTitleText" : "秒杀"
   }
  },
  {
   "path" : "pages/order/order",
   "style" : 
   {
    "navigationBarTitleText" : "订单"
   }
  },
  {
   "path" : "pages/mine/mine",
   "style" : 
   {
    "navigationBarTitleText" : "个人中心"
   }
  }
 ],
 "globalStyle": {
  "navigationBarTextStyle": "black",
  "navigationBarTitleText": "uni-app",
  "navigationBarBackgroundColor": "#F8F8F8",
  "backgroundColor": "#F8F8F8"
 },
 "uniIdRouter": {},

 // 配置 tabBar
 "tabBar": {
  // 默认颜色
  "color": "#7a7e83",
  // 选中颜色
  "selectedColor": "#ce4031",
  // 边框样式
  "borderStyle": "black",
  // 背景颜色
  "backgroundColor": "#f8f8f8",
  // 页面列表
  "list": [
   {
    // 所属页面
    "pagePath": "pages/seckill/seckill",
    // 页面默认图标
    "iconPath": "/static/tabbars/seckill.png",
    // 页面选中图标
    "selectedIconPath": "/static/tabbars/seckillHL.png",
    // 页面名称
    "text": "秒杀"
   },
   // 按顺序摆放, 第二个按钮为“订单”
   {
    "pagePath": "pages/order/order",
    "iconPath": "/static/tabbars/order.png",
    "selectedIconPath": "/static/tabbars/orderHL.png",
    "text": "订单"
   },
   // 第三个按钮为“个人中心”
   {
    "pagePath": "pages/mine/mine",
    "iconPath": "/static/tabbars/mine.png",
    "selectedIconPath": "/static/tabbars/mineHL.png",
    "text": "个人中心"
   }
  ]
 }
}
```

## 首页布局

### 顶部 tab 切换

- 代码

```vue
<template>
 <view class="px-4 py-2 d-flex bg-white">
  <view 
   class="flex-1 d-flex j-center a-center tab border border-theme seckilling border-right-0" 
   :class="selectedTab == TabEnum.SECKILLING ? 'text-white bg-theme' : 'font-theme-color bg-white'"
   
   @tap="onTabTap(TabEnum.SECKILLING)"
   >秒杀中
  </view>
  
  <view 
   class="flex-1 d-flex j-center a-center tab border border-theme seckillwill" 
   :class="selectedTab == TabEnum.SECKILLWILL ? 'text-white bg-theme' : 'font-theme-color bg-white'"
   @tap="onTabTap(TabEnum.SECKILLWILL)"
   >即将秒杀
  </view>
 </view>
</template>

<script setup>
 import { ref } from 'vue';
 

 /* tab切换 */
 const TabEnum = {
  SECKILLING: 1,
  SECKILLWILL: 2,
 }
 
 const selectedTab = ref(TabEnum.SECKILLING);
 
 const onTabTap = (index) => {
  selectedTab.value = index;
 }
</script>

<style scoped lang="scss">
 .tab {
  height: 60rpx;
 }
 
 $borderRadius: 10rpx;
 .seckilling {
  border-start-start-radius: $borderRadius;
  border-end-start-radius: $borderRadius;
 }
 .seckillwill {
  border-start-end-radius: $borderRadius;
  border-end-end-radius: $borderRadius;
 }
</style>
```

- 默认样式中使用了大量来自 `commons/` 中预设好的样式
- `:class="通过三元运算判断样式"` 实现tab切换效果
- `@tap="functionName(args)"` 绑定手机的点击事件, 等同于电脑端的 `@click="functionName(args)"`
- 在script中, 我们实现tab切换功能的逻辑是: 配置枚举, 初始化响应式变量默认为“秒杀中”被选中, 点击事件切换被选中的tab

### 主体商品列表展示

- 封装组件 `~/pages/seckill/components/seckillCard.vue`

```vue
<template>
 <view class="bg-white rounded-10 mt-2 mx-2 d-flex p-2">
  <!-- 左侧: 商品图片 -->
  <view class="product-image over-hidden rounded">
   <image :src="props.goods.photo" class="w-100 h-100"></image>
  </view>
  
  <!-- 右侧: 商品信息 -->
  <view class="flex-1 ml-2 a-center">
   <!-- 标题 -->
   <view class="font text-black product-title over-hidden">{{ props.goods.title }}</view>
   <!-- 标签 -->
   <view class="mt-1">
     <text 
       class="font-sm text-grey" 
       v-for="(tag, index) in props.goods.tags" 
       :key="index"
     >
       {{ tag }} {{ index < props.goods.tags.length - 1 ? ', ' : '' }}
     </text>
   </view>
   <!-- 价格 -->
   <view class="mt-1">
    <text class="font-theme-color font-md">秒杀价 ¥{{ props.goods.seckill_price }}</text>
    <text class="ml-2 text-grey font line-through">原价 ¥{{ props.goods.origin_price }}</text>
   </view>
   <!-- 剩余时间 & 抢购按钮 -->
   <view class="mt-1 d-flex j-sb a-center">
    <text class="text-grey font-sm">
     <template v-if="props.type == TabEnum.SECKILLING">
      剩余xx分钟结束
     </template>
     <template v-else>
      xx:xx开始
     </template>
    </text>
    <view class="text-white px-4 py-1 font bg-theme rounded-10">
     <template v-if="props.type == TabEnum.SECKILLING">
      任性抢
     </template>
     <template v-else>
      预约
     </template>
    </view>
   </view>
  </view>
 </view>
</template>

<script setup>
 // 抽象枚举到 types.js 中
 import { TabEnum } from '../types.js'
 
 const props = defineProps({
  /*
   数据格式: 
   goods = {
    id: 1,
    photo: 'xxx',
    'title': 'xxx',
    tags: ['xx', 'yy'],
    origin_price: 10000,
    seckill_price: 8000,
   }
  */
  goods: {
   type: Object,
   required: true
  },
  type: {
   type: Number,
   
   validator(value) {
     if ([TabEnum.SECKILLING, TabEnum.SECKILLWILL].includes(value)) {
      return true
     }
     
     return false
   },
   
   default: TabEnum.SECKILLING
  }
 })
</script>

<style scoped lang="scss">
 // 商品图片
 .product-image {
  width: 226rpx;
  height: 226rpx;
 }
 
 // 商品标题
 .product-title {
  height: 70rpx;
 }
</style>
```

- 在页面 `~/pages/seckill/seckill.vue` 中导入并传入假数据遍历使用

```vue
<template>
 <!-- 头部: tab切换 -->
 <view class="px-4 py-2 d-flex bg-white">
  <view 
   class="flex-1 d-flex j-center a-center tab border border-theme seckilling border-right-0" 
   :class="selectedTab == TabEnum.SECKILLING ? 'text-white bg-theme' : 'font-theme-color bg-white'"
   
   @tap="onTabTap(TabEnum.SECKILLING)"
   >秒杀中
  </view>
  
  <view 
   class="flex-1 d-flex j-center a-center tab border border-theme seckillwill" 
   :class="selectedTab == TabEnum.SECKILLWILL ? 'text-white bg-theme' : 'font-theme-color bg-white'"
   @tap="onTabTap(TabEnum.SECKILLWILL)"
   >即将秒杀
  </view>
 </view>
 
 <!-- 身体: 商品列表 -->
 <seckillCardVue v-for="goods in goods_list" :goods="goods" :key="goods.title"></seckillCardVue>
</template>

<script setup>
 import { ref } from 'vue';
 // 抽象枚举到 types.js 中
 import { TabEnum } from './types';
 import seckillCardVue from './components/seckillCard.vue';
 
 
 /* tab切换 */
 const selectedTab = ref(TabEnum.SECKILLING);
 
 const onTabTap = (index) => {
  selectedTab.value = index;
 }
 
 /* 假数据 goods_list */
 const goods_list = ref([
  {
   id: 1,
   photo: "/static/product/ae86.jpg",
   title: "测试商品1",
   tags: [
    '分期付款',
    '官方正版'
   ],
   origin_price: 10000,
   seckill_price: 8000,
  },
  {
   id: 2,
   photo: "/static/product/maotai.jpg",
   title: "测试商品2",
   tags: [
    '千年窖藏',
    '李白同款'
   ],
   origin_price: 9999,
   seckill_price: 2.5
  }
 ])
</script>

<style scoped lang="scss">
 .tab {
  height: 60rpx;
 }
 
 // 顶部 tab 样式
 $borderRadius: 10rpx;
 .seckilling {
  border-start-start-radius: $borderRadius;
  border-end-start-radius: $borderRadius;
 }
 .seckillwill {
  border-start-end-radius: $borderRadius;
  border-end-end-radius: $borderRadius;
 }
</style>
```

-
